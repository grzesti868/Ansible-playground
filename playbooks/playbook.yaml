---
# ansible -m copy -a "src=../master.gitconfig dest=~/.gitconfig" localhost
# Playbook to play
- name: Ensure git is installed on hosts
  hosts: all
  become: true
  tasks:
  - yum:
     name: git
     state: latest



- name: Ensure ~/.gitconfig copied from master.gitconfig
  hosts: servers control_node
  become: true
  tasks:

  - name: git_config module to list config
    git_config: 
      list_all: yes 
      scope: global

  - name: show config in targets
    command: git config --global --list
    ignore_errors: true
    register: git_config_before
  - name: show git config
    debug: 
      var: git_config_before
    
  - name: copy and paste file
    copy:
      src: ../master.gitconfig
      dest: ~/.gitconfig

  - name: show newly added config
    command: git config --global --list
    ignore_errors: true
    register: git_config_after

  - name: Ensure git config after with debug
    debug: 
      var: git_config_after.stdout_lines

- name: Ensure packages are updated
  hosts: servers control_node
  become: true
  tasks:
  - yum:
     name: '*'
     state: latest
     exclude: any-package*

